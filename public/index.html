<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ganesh Puja 2025 - Food Token Registration</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          background-color: #fff8f0;
          margin: 0;
          padding: 0;
        }

        header {
          background-color: #d62828;
          color: white;
          text-align: center;
          padding: 20px;
        }

        header img {
          max-width: 100px;
          display: block;
          margin: 0 auto 10px;
        }

        main {
          max-width: 500px;
          margin: 20px auto;
          background: white;
          padding: 20px;
          border-radius: 8px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        h2 {
          color: #d62828;
          text-align: center;
        }

        label {
          display: block;
          margin-top: 10px;
          font-weight: bold;
          color: #333;
        }

        select, input, button {
          width: 100%;
          padding: 8px;
          margin-top: 5px;
          border: 1px solid #ccc;
          border-radius: 4px;
          font-size: 14px;
        }

        button {
          background-color: #d62828;
          color: white;
          font-size: 16px;
          margin-top: 15px;
          cursor: pointer;
          border: none;
          transition: background 0.3s;
        }

        button:hover {
          background-color: #a81e1e;
        }

        #result {
          margin-top: 15px;
          text-align: center;
          font-weight: bold;
        }
    </style>
</head>
<body>
<header style="background-color:#d32f2f; padding:15px; text-align:center; color:white;">
    <img src="https://astromanch.com/public/storage/images/blog_2341754464197.webp"
         alt="Ganesh Puja Banner"
         style="max-width:100%; height:auto; display:block; margin:0 auto;">
    <h1 style="margin:10px 0;">Ganesh Puja 2025</h1>
    <p>Donation & Food Token Registration</p>
</header>

<main>
    <form id="tokenForm">
        <input type="hidden" name="eventName" value="Ganesh Puja 2025">

        <label>Block No:</label>
        <select name="blockNo" required>
            <option value="">Select</option>
            <option value="A1">A1</option>
            <option value="A2">A2</option>
            <option value="B1">B1</option>
            <option value="B2">B2</option>
        </select>

        <label>Flat No:</label>
        <input type="number" name="flatNo" required>

        <label>Number of Tokens:</label>
        <input type="number" name="numTokens" min="1" required>

        <label>Email:</label>
        <input type="email" name="email" required>

        <button type="submit">Get My QR Tokens</button>
    </form>

    <p id="result"></p>
</main>

<script>
    document.getElementById('tokenForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      try {
        const res = await fetch('/.netlify/functions/generate-tokens', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        document.getElementById('result').textContent = result.message || result.error;
      } catch (err) {
        document.getElementById('result').textContent = 'Error submitting form';
      }
    });
</script>
<footer style="background-color:#f4f4f4; text-align:center; padding:15px; font-size:14px; margin-top:20px; border-top:1px solid #ddd;">
    <p><strong>Note:</strong> The QR code will be sent to your registered email ID. This QR is required to scan at the time of claim.
        If you are not comfortable showing the QR, you may state your flat number instead.
        Each claim will reduce your available token count.</p>
    <p style="margin-top:10px; font-style:italic;">Regards,
        <strong>Oceanus Classic Event Management Team</strong></p>
</footer>
</body>
</html>
